{"version":3,"sources":["breaking_point/core.cljs"],"mappings":"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","names":["re_frame.core.reg_event_fx.cljs$core$IFn$_invoke$arity$2","p__83833","vec__83834","cljs.core.nth.cljs$core$IFn$_invoke$arity$3","map__83837","cljs.core/PROTOCOL_SENTINEL","cljs.core.apply.cljs$core$IFn$_invoke$arity$2","cljs.core/hash-map","cljs.core.get.cljs$core$IFn$_invoke$arity$2","_","breakpoints","debounce-ms","opts","G__83844","G__83845","re-frame.core/reg-cofx","coeffect","screen-width","or__4185__auto__","G__83853","js/window","G__83855","js/document","G__83856","screen-height","G__83858","G__83860","G__83861","cljs.core.assoc.cljs$core$IFn$_invoke$arity$variadic","p__83862","map__83863","breaking-point.core/set-screen-dimensions","db","cljs.core/assoc-in","re_frame.core.reg_event_fx.cljs$core$IFn$_invoke$arity$3","G__83865","re-frame.core/inject-cofx","p__83866","vec__83867","breaking-point.core/get-screen-width","cljs.core.get_in.cljs$core$IFn$_invoke$arity$2","breaking-point.core/get-screen-height","breaking-point.core/->get-screen","cljs.core.reduce.cljs$core$IFn$_invoke$arity$3","p__83870","vec__83871","prev-breakpoint","screen-key","breakpoint","cljs.core/reduced","cljs.core.partition_all.cljs$core$IFn$_invoke$arity$2","p__83874","vec__83875","breaking-point.core/get-orientation","breaking-point.core/register-subs","G__83878","G__83879","re-frame.core/reg-sub","G__83880","G__83881","G__83882","G__83883","G__83884","G__83885","G__83886","G__83887","G__83888","G__83889","G__83890","G__83891","G__83892","G__83893","G__83894","G__83895","orientation","cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2","G__83896","G__83897","G__83898","G__83899","screen-keys","G__83900","cljs.core.map_indexed.cljs$core$IFn$_invoke$arity$2","cljs.core/vector","cljs.core.filter.cljs$core$IFn$_invoke$arity$2","p__83901","vec__83902","i","k","cljs.core/even?","cljs.core.mapv.cljs$core$IFn$_invoke$arity$2","cljs.core/second","seq__83905","cljs.core/seq","chunk__83906","count__83907","i__83908","temp__5735__auto__","cljs.core/chunked-seq?","c__4609__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","cljs.core/count","cljs.core/first","cljs.core/next","G__83917","G__83918","G__83919","G__83920","G__83921","G__83922","G__83923","G__83924","cljs.core.keyword.cljs$core$IFn$_invoke$arity$2","cljs.core/name","screen","p__83925","map__83926","breaking-point.core/set-breakpoints","G__83928","re-frame.core/dispatch","G__83929","G__83930","G__83931","G__83932","re-frame.core/reg-fx"],"sourcesContent":["(ns breaking-point.core\n  (:require\n   [re-frame.core :as rf]\n   [re-frame-fx.dispatch]\n   ))\n\n\n;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n;; PUBLIC API\n;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\n(rf/reg-event-fx\n ::set-breakpoints\n (fn [_ [_ {:keys [breakpoints ;; required\n                   debounce-ms ;; optional\n                   ]\n            :as   opts}]]\n   {::set-breakpoints opts}))\n\n\n\n\n;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n;; Implementation\n;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\n;; COFX\n\n(rf/reg-cofx\n ::screen-dimensions\n (fn [coeffect]\n   (let [screen-width  (or (some-> js/window\n                                   .-innerWidth)\n                           (some-> js/document\n                                   .-documentElement\n                                   .-clientWidth)\n                           (some-> js/document\n                                   .-body\n                                   .-clientWidth))\n         screen-height (or (some-> js/window\n                                   .-innerHeight)\n                           (some-> js/document\n                                   .-documentElement\n                                   .-clientHeight)\n                           (some-> js/document\n                                   .-body\n                                   .-clientHeight))]\n     (assoc coeffect\n            :screen-width screen-width\n            :screen-height screen-height))))\n\n\n;; Events\n\n(defn set-screen-dimensions\n  [{:keys [db\n           screen-width\n           screen-height]} _]\n  {:db (-> db\n           (assoc-in [::breakpoints :screen-width] screen-width)\n           (assoc-in [::breakpoints :screen-height] screen-height))})\n\n(rf/reg-event-fx ::set-screen-dimensions\n                 [(rf/inject-cofx ::screen-dimensions)]\n                 set-screen-dimensions)\n\n(rf/reg-event-fx ::set-screen-dimensions-debounced\n                 (fn [_ [_ debounce-ms]]\n                   {:dispatch-debounce [{:id      ::calcaulate-width-after-resize\n                                         :timeout debounce-ms\n                                         :action  :dispatch\n                                         :event   [::set-screen-dimensions]}]}))\n\n\n;; Subs\n\n(defn get-screen-width [db _]\n  (get-in db [::breakpoints :screen-width]))\n\n(defn get-screen-height [db _]\n  (get-in db [::breakpoints :screen-height]))\n\n\n(defn ->get-screen [breakpoints]\n  (fn get-screen\n    [screen-width _]\n    (when screen-width\n      (reduce\n       (fn [prev-breakpoint [screen-key breakpoint]]\n         (if (or (nil? breakpoint)\n                 (and (< screen-width breakpoint)\n                      (>= screen-width prev-breakpoint)))\n           (reduced screen-key)\n           breakpoint))\n       0\n       (partition-all 2 breakpoints)))))\n\n\n(defn get-orientation\n  [[screen-width\n    screen-height] _]\n  (if (> screen-height\n         screen-width)\n    :portrait\n    :landscape))\n\n\n(defn register-subs [breakpoints]\n  (rf/reg-sub ::screen-width get-screen-width)\n  (rf/reg-sub ::screen-height get-screen-height)\n\n  (rf/reg-sub ::screen\n              :<- [::screen-width]\n              (->get-screen breakpoints))\n\n  (rf/reg-sub ::orientation\n              :<- [::screen-width]\n              :<- [::screen-height]\n              get-orientation)\n\n  (rf/reg-sub ::portrait?\n              :<- [::orientation]\n              (fn [orientation _]\n                (= orientation :portrait)))\n\n  (rf/reg-sub ::landscape?\n              :<- [::orientation]\n              (fn [orientation _]\n                (= orientation :landscape)))\n\n  (let [screen-keys (some->> breakpoints\n                             (map-indexed vector)\n                             (filter (fn [[i k]]\n                                       (even? i)))\n                             (mapv second))]\n    (doseq [screen-key screen-keys]\n      (rf/reg-sub (keyword \"breaking-point.core\"\n                           (str (name screen-key) \"?\"))\n                  :<- [::screen]\n                  (fn [screen _]\n                    (= screen\n                       screen-key))))))\n\n\n;; FX\n\n(defn set-breakpoints [{:keys [breakpoints\n                               debounce-ms]\n                        :as   opts}]\n  (register-subs breakpoints)\n  (rf/dispatch [::set-screen-dimensions])\n  (.addEventListener js/window \"resize\"\n                     #(if debounce-ms\n                        (rf/dispatch [::set-screen-dimensions-debounced debounce-ms])\n                        (rf/dispatch [::set-screen-dimensions]))\n                     true))\n\n(rf/reg-fx\n ::set-breakpoints\n set-breakpoints)\n"]}